<%- include header%>
  <div class="container bg-white" id="context" style="margin-bottom:212px">
    <form class="col-sm-offset-3 col-sm-6 " role="form" method="post" onsubmit="return false">
      <fieldset>
        <legend></legend>
        <div class="panel panel-default ">
          <div class="panel-heading">
            <p class="tc">请先登录</p>
          </div>
          <div class="panel-body m15">
            <div class="form-group row">
              <label for="inputusername" class="col-2 col-form-label">用户名</label>
              <div class="col-sm-7">
                <input type="text" class="form-control" id="username" placeholder="请输入用户名">
              </div>
            </div>
            <div class="form-group row">
              <label for="inputpassword" class="col-2 col-form-label">密码</label>
              <div class="col-7">
                <input type="password" class="form-control" id="password" placeholder="请输入密码">
              </div>
            </div>
            <div class=" form-group row ">
              <label class="col-2 col-form-label"></label>
              <button type="submit" class="btn btn-primary btn-block mx-2 col-2" id="onload0">登录</button>
              <button type="button" class="btn btn-info col-4 " id="onload1">通过 GitHub 登陆</button>
            </div>
            <div id="text">你好！
              <span id="name"></span>
            </div>
          </div>
        </div>
      </fieldset>
    </form>
  </div>

  <script>
    $(document).ready(function () {
      $("#onload0").click(function () {
        // $('#text').load('/demo')
        var username = $("#username").val();
        var password = $("#password").val();
        var data = { uname: username, upwd: password };
        $.ajax({
          url: '/onload',
          type: 'post',
          contentType: "application/json",
          data: JSON.stringify(data),
          success: function (data, status) {
            if (status == 'success') {
              $("#name").html(username + "登陆成功");
              setTimeout(() => {
                window.location.href = "/home"
              }, 1000)
            }
          },
          error: function (data, status) {
            if (status == 'error') {
              $("#name").html("用户名或密码错误");
            }
          }
        });
      });
    });
  </script>

  <%- include footer%>