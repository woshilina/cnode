<%- include header%>
  <div class="d-flex justify-content-center my-3 ">

    <div class="col-8 card p-0 mr-3  border-0">
      <div class="card-header">
        <button type="button" class="btn btn-success" value="all">全部</button>
        <button type="button" class="btn btn-success" value="essence">精华</button>
        <button type="button" class="btn btn-success" value="share">分享</button>
        <button type="button" class="btn btn-success" value="ask">问答</button>
        <button type="button" class="btn btn-success" value="job">招聘</button>
        <button type="button" class="btn btn-success" value="dev">客户端测试</button>
      </div>
      <div id="text">
        <%topics.forEach(function(res,index){%>
          <div class="list-group-item list-group-item-action" id="<%=res['id']%>">
            <div class="media">
              <img class="mr-3 " src="/images/3118295.jpg" width="40" height="40" alt="Generic placeholder image">
              <div class="media-body align-self-center d-flex  justify-content-between">
                <div>
                  <%=res['replies']%>/
                    <small>
                      <%=res['clicks']%>
                    </small>
                    <span class="badge badge-secondary">
                      <%=res['tabValue']%>
                    </span>
                    <a href="/topic/<%=res['id']%>">
                      <%=res['title']%>
                    </a>
                </div>
                <div class="col-2 d-flex  justify-content-between">
                  <img src="/images/7081645.png" width="30" height="30" alt="Generic placeholder image">
                  <small class="align-self-center">
                    <%=retime[index]%>
                  </small>
                </div>
              </div>
            </div>
          </div>
          <%})%>
      </div>
      <nav aria-label="Page navigation example">
        <ul class="pagination">
          <li class="page-item">
            <a class="page-link" href="#" aria-label="Previous">
              <span aria-hidden="true">&laquo;</span>
              <span class="sr-only">Previous</span>
            </a>
          </li>
          <li class="page-item">
            <a class="page-link" href="#">1</a>
          </li>
          <li class="page-item">
            <a class="page-link" href="#">2</a>
          </li>
          <li class="page-item">
            <a class="page-link" href="#">3</a>
          </li>
          <li class="page-item" id="next">
            <a class="page-link" href="#" aria-label="Next">
              <span aria-hidden="true">&raquo;</span>
              <span class="sr-only">Next</span>
            </a>
          </li>
        </ul>
      </nav>
    </div>


    <div class="col-2.5">
      <% if(!session||!session.id){ %>
        <div class="bg-white pt-3 pl-3 pb-1">
          <p>CNode：Node.js专业中文社区 </p>
          <p>
            <small>您可以
              <a href="/onload" class="text-muted">登录</a>或
              <a href="/signin" class="text-muted">注册</a> , 也可以</small>
            </br>
            <a class="btn btn-primary" href="#" role="button">通过GitHub登陆</a>
          </p>
        </div>
        <% } %>
          <% if(session&&session.id){ %>
            <div class='card bg-white '>
              <div class='card-header  '>
                个人信息
              </div>
              <div class='card-body'>
                <div class='user_card'>
                  <div>
                    <a class='user_avatar' href="/user/<%=session.name%>">
                      <img src="#" title="<%=session.name%>" />
                    </a>
                    <span class='user_name'>
                      <a class='dark' href="/user/<%=session.name%>">
                        <%=session.name%>
                      </a>
                    </span>

                    <div class='board clearfix'>
                      <div class='floor'>
                        <span class='big'>积分:
                          <%=session.integral%>
                        </span>
                      </div>
                    </div>
                    <div class="space clearfix"></div>
                    <%if(session.sign==null){%>
                      <span class="signature">
                        “这家伙很懒，什么个性签名都没有留下。”
                      </span>
                      <%}%>
                        <%if(session.sign!=null){%>
                          <span class="signature">
                            <%=session.sign%>
                          </span>
                          <%}%>
                  </div>
                </div>
              </div>
            </div>
            <div class="panel">
              <div class='inner bg-white p-3 mt-3'>
                <a href='/topic/create' id='create_topic_btn'>
                  <button type="button" class="btn btn-success">
                    发布话题
                  </button>
                </a>
              </div>
            </div>
            <% } %>
              <div class="mt-3">
                <a href="#">
                  <img src="/images/FgQS-GQD" width="350" height="120">
                </a>
              </div>
              <div class="mt-3">
                <ul class="list-group">
                  <li class="list-group-item">无人回复的话题</li>
                  <%topics.forEach(function(res){%>
                    <%if(res.replies===0){%>
                      <li class="list-group-item">
                        <a href="/topic/<%=res.id%>" class="text-muted">
                          <%=res.title%>
                        </a>
                      </li>
                      <%}})%>
                </ul>
              </div>
    </div>

  </div>
  <script>
    $(document).ready(function () {
      // 导航栏的切换
      $('button').each(function () {
        $(this).on('click', function () {
          var value = $(this).attr('value');
          var page = 1;
          $.ajax({
            url: '/home/tab/' + value,
            type: "GET",
            cache: false,
            dataType: 'json',
            success: function (msg) {
              total = msg.total;
              time = msg.time;
              $('#text').empty();
      
            },
            error: function () {
              alert('异常');
            }
          })
        })
      })

      function page(total) {
        var page = (total % 5 == 0) ? (total / 5) : (total / 5 + 1);

        if (page < 5) {
          for (var i = 1; i <= page; i++) {
            var text = document.createElement('li');
            $('#next').before('')
          }
        }
      }
      var currentpage = 1;
     

    })
  </script>
  <%- include footer%>